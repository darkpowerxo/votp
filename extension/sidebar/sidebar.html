<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice of the People</title>
    <link rel="stylesheet" href="sidebar.css">
</head>
<body>
    <div id="app">
        <!-- Loading State -->
        <div id="loading-screen" class="loading-screen">
            <div class="loading-spinner"></div>
            <p>Loading Voice of the People...</p>
        </div>

        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <img src="../icons/icon48.png" alt="VOTP" class="logo-icon">
                    <h1 class="logo-text">VOTP</h1>
                </div>
                <button id="close-btn" class="close-btn" title="Close sidebar">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M12.854 3.146a.5.5 0 0 1 0 .708L8.707 8l4.147 4.146a.5.5 0 0 1-.708.708L8 8.707l-4.146 4.147a.5.5 0 0 1-.708-.708L7.293 8 3.146 3.854a.5.5 0 1 1 .708-.708L8 7.293l4.146-4.147a.5.5 0 0 1 .708 0z"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Authentication Section -->
            <div id="auth-section" class="auth-section">
                <!-- Sign In Form -->
                <div id="signin-form" class="auth-form">
                    <h2>Join the Conversation</h2>
                    <p class="auth-description">Share your voice and engage with the community on any webpage.</p>
                    
                    <form id="email-form">
                        <div class="form-group">
                            <label for="email-input">Email</label>
                            <input type="email" id="email-input" placeholder="Enter your email" required>
                        </div>
                        <button type="submit" class="btn btn-primary" id="email-next-btn">
                            <span class="btn-text">Next</span>
                            <div class="btn-spinner hidden"></div>
                        </button>
                    </form>
                </div>

                <!-- Password Form (Login) -->
                <div id="password-form" class="auth-form hidden">
                    <h2>Welcome Back!</h2>
                    <p class="auth-description">Enter your password to continue.</p>
                    
                    <form id="login-form">
                        <div class="form-group">
                            <label>Email</label>
                            <div id="login-email" class="form-display-value"></div>
                        </div>
                        <div class="form-group">
                            <label for="password-input">Password</label>
                            <input type="password" id="password-input" placeholder="Enter your password" required>
                        </div>
                        <button type="submit" class="btn btn-primary" id="login-btn">
                            <span class="btn-text">Sign In</span>
                            <div class="btn-spinner hidden"></div>
                        </button>
                        <button type="button" class="btn btn-secondary" id="back-to-email-btn">Back</button>
                    </form>
                </div>

                <!-- Sign Up Form -->
                <div id="signup-form" class="auth-form hidden">
                    <h2>Create Account</h2>
                    <p class="auth-description">We'll send you a verification code to get started.</p>
                    
                    <div id="signup-step-1">
                        <div class="form-group">
                            <label>Email</label>
                            <div id="signup-email" class="form-display-value"></div>
                        </div>
                        <button type="button" class="btn btn-primary" id="send-code-btn">
                            <span class="btn-text">Send Verification Code</span>
                            <div class="btn-spinner hidden"></div>
                        </button>
                        <button type="button" class="btn btn-secondary" id="back-to-email-btn-2">Back</button>
                    </div>

                    <div id="signup-step-2" class="hidden">
                        <form id="verification-form">
                            <div class="form-group">
                                <label>Email</label>
                                <div id="verify-email" class="form-display-value"></div>
                            </div>
                            <div class="form-group">
                                <label for="verification-code">Verification Code</label>
                                <input type="text" id="verification-code" placeholder="Enter 6-digit code" maxlength="6" pattern="[0-9]{6}" required>
                                <small class="form-help">Check your email for the 6-digit verification code</small>
                            </div>
                            <div class="form-group">
                                <label for="name-input">Full Name</label>
                                <input type="text" id="name-input" placeholder="Enter your full name" required>
                            </div>
                            <div class="form-group">
                                <label for="new-password-input">Password</label>
                                <input type="password" id="new-password-input" placeholder="Create a password" required minlength="8">
                                <small class="form-help">At least 8 characters</small>
                            </div>
                            <button type="submit" class="btn btn-primary" id="complete-signup-btn">
                                <span class="btn-text">Complete Sign Up</span>
                                <div class="btn-spinner hidden"></div>
                            </button>
                            <button type="button" class="btn btn-secondary" id="resend-code-btn">Resend Code</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- User Section (when authenticated) -->
            <div id="user-section" class="user-section hidden">
                <!-- User Profile -->
                <div class="user-profile">
                    <div class="user-avatar">
                        <div class="avatar-circle" id="user-avatar"></div>
                    </div>
                    <div class="user-info">
                        <h3 id="user-name" class="user-name"></h3>
                        <p id="user-email" class="user-email"></p>
                    </div>
                    <button id="logout-btn" class="logout-btn" title="Sign out">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z"/>
                            <path d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
                        </svg>
                    </button>
                </div>

                <!-- Page Info -->
                <div class="page-info">
                    <h4 id="page-title" class="page-title"></h4>
                    <p id="page-url" class="page-url"></p>
                </div>

                <!-- Comment Form -->
                <div class="comment-form">
                    <h4>Share Your Thoughts</h4>
                    <form id="new-comment-form">
                        <div class="form-group">
                            <textarea id="comment-input" placeholder="What do you think about this page?" rows="3" maxlength="5000" required></textarea>
                            <small class="form-help"><span id="char-count">0</span>/5000 characters</small>
                        </div>
                        <button type="submit" class="btn btn-primary" id="post-comment-btn">
                            <span class="btn-text">Post Comment</span>
                            <div class="btn-spinner hidden"></div>
                        </button>
                    </form>
                </div>

                <!-- Comments List -->
                <div class="comments-section">
                    <div class="comments-header">
                        <h4>Community Comments</h4>
                        <button id="refresh-comments-btn" class="refresh-btn" title="Refresh comments">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
                                <path d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
                            </svg>
                        </button>
                    </div>
                    
                    <div id="comments-list" class="comments-list">
                        <div id="comments-loading" class="comments-loading hidden">
                            <div class="loading-spinner small"></div>
                            <p>Loading comments...</p>
                        </div>
                        <div id="comments-empty" class="comments-empty hidden">
                            <p>No comments yet. Be the first to share your thoughts!</p>
                        </div>
                        <div id="comments-error" class="comments-error hidden">
                            <p>Failed to load comments. <button class="retry-btn">Try again</button></p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Toast Notifications -->
        <div id="toast-container" class="toast-container"></div>

        <!-- Error Messages -->
        <div id="error-banner" class="error-banner hidden">
            <span id="error-message"></span>
            <button id="dismiss-error" class="dismiss-btn">×</button>
        </div>
    </div>

    <script src="sidebar.js"></script>
</body>
</html>